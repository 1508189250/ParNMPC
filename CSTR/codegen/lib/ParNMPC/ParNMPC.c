/*
 * File: ParNMPC.c
 *
 * MATLAB Coder version            : 3.1
 * C/C++ source code generated on  : 21-Jan-2018 02:06:04
 */

/* Include Files */
#include "rt_nonfinite.h"
#include "ParNMPC.h"
#include "inv.h"
#include "GEN_Func_KKT.h"
#include "Func_Hxx_FD.h"
#include "GEN_Func_Hux.h"
#include "GEN_Func_dKKT23_mu_u.h"
#include "GEN_Func_fx_I.h"
#include "GEN_Func_fu.h"
#include "FuncPlantSim.h"
#include "norm.h"
#include "fprintf.h"
#include "fclose.h"
#include "fopen.h"
#include <stdio.h>
#include "omp.h"
#include "stdio.h"

/* Function Definitions */

/*
 * % Load and init parameters
 *  dimension variables
 * Arguments    : void
 * Return Type  : void
 */
void ParNMPC(void)
{
  double xCurrentState[4];
  int i;
  static const double b_xCurrentState[4] = { 1.0, 0.5, 100.0, 100.0 };

  double rec_x[1444];
  int i0;
  double rec_u[1440];
  static const double dv0[4] = { 1.0, 0.5, 100.0, 100.0 };

  signed char rec_numIter[360];
  double rec_error[360];
  double rec_cpuTime[360];
  double currentEval[336];
  double currentIteration[336];
  double theta[384];
  static const double dv1[384] = { -0.015541992853892779, -0.057914232418394475,
    -0.046086728138222149, -0.017980160992485762, -0.057914528629161209,
    -0.043194963183788855, -0.019736079782671435, -0.00777289490118385,
    -0.0460871691146199, -0.019736072619879742, -0.025804466109835771,
    -0.0092959978420783761, -0.017980282281087914, -0.00777289244347531,
    -0.0092959968357757411, -0.0039374239923846439, -0.044325201973776977,
    -0.054473110902761586, -0.042851918053084942, -0.017184964483227261,
    -0.054473340603998138, -0.03760895534716828, -0.016044926526669948,
    -0.0065888139112085424, -0.0428522484993549, -0.016044915670109419,
    -0.021153779020611788, -0.00781113310879418, -0.017185053897939295,
    -0.0065888103825829242, -0.0078111323600922114, -0.0034626907011345931,
    -0.069542073259627607, -0.056114738506973467, -0.042520122798087666,
    -0.017337382036192152, -0.056114932180161066, -0.036764437849375185,
    -0.015075217894756654, -0.0063514862757059641, -0.042520382872343415,
    -0.015075204863011836, -0.018946130054552965, -0.0071290431679295477,
    -0.017337451446126258, -0.0063514821313973274, -0.0071290426150550142,
    -0.003251223626987044, -0.093354705802699861, -0.062825882765792138,
    -0.044710601922725843, -0.018272301607215904, -0.062826057814947392,
    -0.040222102196059713, -0.015773931853513539, -0.006757295883784052,
    -0.044710819334954563, -0.015773915217081744, -0.0183832114395189,
    -0.0069733197195916904, -0.018272357635940081, -0.0067572911643435651,
    -0.006973319435972139, -0.0031904586326154966, -0.11847416065875781,
    -0.070120185423354589, -0.047966358494599924, -0.018985237155346887,
    -0.0701203173380004, -0.044186345349229834, -0.018389141660143205,
    -0.0074931103299407092, -0.04796652071915284, -0.018389129238883032,
    -0.018868388350898432, -0.0070378103637040515, -0.018985277666305068,
    -0.0074931069201892532, -0.0070378101850291164, -0.003174761845711162,
    -0.12876330305542227, -0.071344564062516408, -0.047418684047826669,
    -0.018346346341146142, -0.071344646921217669, -0.045563749910044193,
    -0.019446688389128497, -0.0076591375995984316, -0.047418789673986515,
    -0.019446679723987798, -0.018407343011301189, -0.0067778408155115535,
    -0.018346371449621104, -0.0076591353352231852, -0.0067778407452879913,
    -0.0030468671354937937, -0.12803305474385818, -0.067798155509107741,
    -0.044143186927509674, -0.016764022966552324, -0.067798191496231924,
    -0.044685616491730341, -0.019172366400338953, -0.0073498763396951852,
    -0.044143240712467016, -0.019172360790044859, -0.017257858376851024,
    -0.0062810936217147072, -0.01676403443332997, -0.00734987498568984,
    -0.0062810936452714489, -0.0028361499694771518, -0.12071615172574414,
    -0.061307738237871126, -0.039291569996487127, -0.014644171048030669,
    -0.061307734850638694, -0.042217593245944554, -0.01793618712444036,
    -0.0066999188828269132, -0.039291580485005154, -0.01793618386326068,
    -0.015676390444144067, -0.0056309730020558694, -0.014644171604010789,
    -0.0066999182045207285, -0.005630973094296267, -0.0025691489144171985,
    -0.11048303665606923, -0.053587579898640429, -0.033808598763846377,
    -0.01231001922143855, -0.053587547138205273, -0.038900315984957058,
    -0.016121246515324313, -0.0058434420101804684, -0.033808576131206004,
    -0.016121245005992303, -0.013872779945005397, -0.0048941462121652865,
    -0.012310011985531919, -0.00584344180567732, -0.0048941463437612394,
    -0.0022662531971810451, -0.10000751304008829, -0.046016015962188683,
    -0.028405012299308197, -0.010004222230399719, -0.046015964207368608,
    -0.035413036864136493, -0.014075419149925671, -0.00490180024835326,
    -0.028404966786547702, -0.014075418917635843, -0.012015462322111472,
    -0.0041246291327589751, -0.010004210297862155, -0.0049018003532534981,
    -0.0041246292755310662, -0.0019439309304510452, -0.091147397455377546,
    -0.039619613110794517, -0.02362750846678879, -0.0079215846878522636,
    -0.039619551621446827, -0.032318990943787512, -0.012108805063867559,
    -0.0039869248054670448, -0.023627449273585722, -0.012108805731163529,
    -0.010258466976469798, -0.0033761361374086544, -0.0079215708177258967,
    -0.0039869250883142957, -0.0033761362698815573, -0.0016204150710265946,
    -0.085114174452920258, -0.035099991150904189, -0.019926100700318649,
    -0.0062423435218809907, -0.035099926926006011, -0.030042245889260029,
    -0.010503110017385818, -0.0032104631428343782, -0.019926035067948687,
    -0.010503111275913432, -0.0087709392241987413, -0.0027178729897300684,
    -0.0062423297955904586, -0.0032104635038001888, -0.002717873102129498,
    -0.001324266128551256, -0.082512055012746541, -0.032833056462600194,
    -0.017667381903762013, -0.0051471714222218771, -0.032832993302376962,
    -0.028846555561071931, -0.009506438596737863, -0.0026886496125792035,
    -0.017667314284788828, -0.0095064402185221514, -0.0077465032656596948,
    -0.0022443793388102129, -0.005147158809601168, -0.0026886499940235505,
    -0.0022443794341411717, -0.0011019637713584136, -0.083236164192485113,
    -0.032804969905181745, -0.017029066726062466, -0.004765541069651282,
    -0.032804908276450342, -0.028787885819864134, -0.0092689222071152839,
    -0.0025125859522162402, -0.017028998664989192, -0.00926892406640088,
    -0.0073356920885931046, -0.0020433920898558838, -0.0047655292652286577,
    -0.0025125863471861646, -0.0020433921784372457, -0.0010027600881150412,
    -0.086224924310603218, -0.034456597409066057, -0.017751855535758511,
    -0.0050197778111706216, -0.03445653636072573, -0.029613171435291311,
    -0.00969542737186202, -0.0026583969334643925, -0.017751787389442542,
    -0.0096954294192627462, -0.0074831068104493663, -0.0021023321267052142,
    -0.0050197660395755366, -0.0026583973633922961, -0.0021023322176377877,
    -0.0010264121913141542, -0.089660972110676862, -0.036776998452881078,
    -0.019182067759636597, -0.00561889752928337, -0.036776938127556495,
    -0.03079898984467459, -0.01045872997813403, -0.002978998034801976,
    -0.019182000705303449, -0.010458732169077205, -0.0079385023318837879,
    -0.0023054888453654348, -0.0056188855441232149, -0.0029789985104205696,
    -0.0023054889410986353, -0.00111855264926141, -0.091814867967333291,
    -0.038775702478386236, -0.020708438632710553, -0.0062819930647929874,
    -0.038775644485059449, -0.031813127071360962, -0.011240192094922495,
    -0.0033265052943359935, -0.020708374797826688, -0.011240194357958408,
    -0.0084744534927775252, -0.0025453489374889404, -0.00628198120962968,
    -0.0033265058043097802, -0.002545349034629205, -0.0012277903474535118,
    -0.091318987550016148, -0.039655936613247331, -0.021920211528382902,
    -0.006828968700610524, -0.039655883191124293, -0.032219321726802939,
    -0.011824871111552416, -0.0036054311971127685, -0.021920153289325662,
    -0.011824873352664408, -0.0089633690036704829, -0.0027637014911619687,
    -0.006828957555273703, -0.0036054317158639416, -0.0027637015837874124,
    -0.0013271710325469331, -0.0868554532241437, -0.038659936761480426,
    -0.022467999546506953, -0.00712369841128123, -0.038659890117977457,
    -0.03159507792487324, -0.012033328405822103, -0.0037448447162416708,
    -0.022467949040151154, -0.012033330522254882, -0.00932302365053439,
    -0.002927451385248153, -0.0071236885489883136, -0.0037448452125565862,
    -0.0029274514671833477, -0.0014030745035812546, -0.076949708306048845,
    -0.034957010584268963, -0.021887752015210617, -0.00700166173985448,
    -0.034956972626495851, -0.029453077104455192, -0.011631820979989781,
    -0.0036612130165793763, -0.021887710944735149, -0.011631822863586029,
    -0.00944157673589486, -0.0029969317502807112, -0.0070016536284581207,
    -0.0036612134574768862, -0.0029969318159740891, -0.0014413864405432332,
    -0.0603802047037255, -0.027842001359663741, -0.019503026243177214,
    -0.0062337606437895083, -0.027841973600846368, -0.025285981714095487,
    -0.010284095737908663, -0.0032404079733952739, -0.019502995823676521,
    -0.01028409727861372, -0.009095157876532688, -0.0028950542222137918,
    -0.0062337546183752575, -0.0032404083260890479, -0.0028950542670768032,
    -0.001415400632895096, -0.037760286420017615, -0.017525660664103736,
    -0.01458333595639395, -0.0045887330179521547, -0.017525643963513513,
    -0.0188217814186559, -0.0076354291743683722, -0.002370788586381766,
    -0.014583316833495926, -0.0076354302527324716, -0.0078539531458329762,
    -0.0024754378098283073, -0.0045887292621364338, -0.002370788820228599,
    -0.0024754378316600547, -0.0012721476190099828, -0.014296849135791068,
    -0.0065366597429392338, -0.00718620026380733, -0.0021478223523622515,
    -0.006536653355302899, -0.010360697204992985, -0.0037420814111425063,
    -0.0011036123294330107, -0.0071861920873924059, -0.0037420819223815431,
    -0.0050506199040895152, -0.0015230023186794596, -0.00214782079594538,
    -0.0011036124294880319, -0.0015230023221847167, -0.00090706455377998147, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };

  static const double dv2[336] = { -0.63404374460295321, -0.3171925407644553,
    -0.35746874125033562, -0.14041161110081218, -0.47459564229254153,
    1.4983116152049331E-6, 12.793729850993941, -0.00015902606972406947,
    -16.856858621579548, 1.1963421748922718, 1.5706148303913288,
    0.502277887256571, 101.20053080590365, 100.72125862092351,
    -0.592347592483623, -0.26208248839420956, -0.29659252143872733,
    -0.11782660999322103, -0.46996700540366304, 1.2514919920517876E-6,
    15.077343598869433, -1.91767396140935, -17.332901111896419,
    131.35976621181678, 2.0461377362994768, 0.53809405616492445,
    102.55594514248955, 101.82218930213877, -0.524546051909047,
    -0.21581707055902932, -0.24334147023434147, -0.097315719935223643,
    -0.46920097784096648, 1.0268991917248885E-6, 17.187698523504565,
    -7.7531115853563364, -17.498233872939988, 264.04146176103455,
    2.4088077073332022, 0.59584096288976374, 104.0543691697771,
    103.15789003151362, -0.44230183879489826, -0.17594925417041937,
    -0.19748560811761698, -0.078754925206406659, -0.47055137524890522,
    8.2360538079623116E-7, 18.866542059669495, -17.720237233556968,
    -17.447176263002476, 398.95880525987525, 2.6556395675233606,
    0.665529569932173, 105.61476241714706, 104.6216785698122,
    -0.3509987129020376, -0.13991470515557414, -0.15909194610614269,
    -0.061645178325221484, -0.027642542001944839, 6.3647998267278216E-7,
    14.528778454316813, -32.011098395284556, 17.245956275456834,
    535.79396705912916, 2.6591823080306236, 0.77267868100134141,
    107.12280159754938, 106.10214894962104, -0.23100906756179274,
    -0.092349088252099282, -0.1154531604300526, -0.044293426184101169,
    -0.025995899286819932, 4.4727947233893108E-7, 13.886688855998342,
    -50.79121963718007, 17.122924226393575, 674.19672851651944,
    2.607211256403847, 0.8688769259751733, 108.51683379485218,
    107.51767224724082, -0.12160899977502528, -0.047481322032883605,
    -0.076607033046593734, -0.029012639030265904, -0.024878086852300613,
    2.8186201282645725E-7, 13.532247916647611, -74.194014649248714,
    17.044270561046151, 813.78214531501885, 2.5299697854877286,
    0.94851622399286917, 109.7757264711844, 108.8228737212053,
    -0.029247730824533635, -0.0078383526702277134, -0.0435281880873993,
    -0.016057047230238694, -0.024323320561912356, 1.4312952931537691E-7,
    13.381646708422405, -102.31708276241636, 17.008504679041458,
    954.14095365241712, 2.4462261287241658, 1.009720431299318,
    110.88668043401066, 109.99188205780331, 0.044255551019845255,
    0.025267859019356829, -0.016377840884230596, -0.00542993696730277,
    -0.024207788397470131, 3.1067098221475936E-8, 13.365138059351782,
    -135.21823256340568, 17.004497306827332, 1094.842510433841,
    2.3667432720812718, 1.0534058638808663, 111.84627229430812,
    111.01227236043023, 0.099713127668592458, 0.051429752487784315,
    0.0051645276657654744, 0.0030123922514791795, -0.0243707373913255,
    -5.6068799250674639E-8, 13.428777688659521, -172.91248511605014,
    17.019845712694487, 1235.4406657283996, 2.2968426519917773,
    1.0821881436501073, 112.65878532476303, 111.8816474406763,
    0.13911808436982442, 0.070827879053194653, 0.0216561149825531,
    0.0094855835551130377, -0.024674504639991119, -1.2088590346178294E-7,
    13.533271880945316, -215.36999826373739, 17.044502536766576,
    1375.4801882330146, 2.2383668631177351, 1.0993749009843068,
    113.33384778654452, 112.60485559391468, 0.16478196437670431,
    0.083977195658888087, 0.033733784979962322, 0.014229066379859602,
    -0.025022828746116488, -1.662964237195516E-7, 13.651764914454638,
    -262.51514059992684, 17.071645678106069, 1514.5039010696191,
    2.191140520771099, 1.1082236733487798, 113.88418717109808,
    113.19153131051762, 0.17891344957579272, 0.091551394760089624,
    0.042024709843324522, 0.017478227594761846, -0.0253578482355547,
    -1.9518911393073992E-7, 13.767216800038991, -314.22671283997505,
    17.097260842979637, 1652.0599227926232, 2.1539846187201985,
    1.111516285390274, 114.32381128847359, 113.65402055342675,
    0.18346598508993783, 0.0942756676001637, 0.047102788712118232,
    0.019450429458209795, -0.025649817244278783, -2.102598571408883E-7,
    13.869800009769939, -370.33940274335845, 17.119335414097783,
    1787.7089672163936, 2.12535798088126, 1.1113999054062129, 114.66670112946579,
    114.00576618522005, 0.1801233552072361, 0.092870087708672514,
    0.04947327487085771, 0.02033974970590172, -0.025886767057071155,
    -2.139421751321316E-7, 13.954625695880065, -430.64641435165186,
    17.137103490798221, 1921.0313362803149, 2.1037180402154356,
    1.1094027182750421, 114.92598286673727, 114.26016413651267,
    0.1703435541985075, 0.088026443061096818, 0.049573212826543644,
    0.020316805779059127, -0.026066672754106655, -2.0839578231634726E-7,
    14.019946935530738, -494.90320203176742, 17.15048757548043,
    2051.6334075327904, 2.0876922313050503, 1.1065366040111746,
    115.11348786800779, 114.42983985164911, 0.15542046801991691,
    0.080405385620325384, 0.047779722739944873, 0.019531277750401626,
    -0.026192314919859731, -1.9552559107117647E-7, 14.065841050917381,
    -562.83206494977651, 17.159736149649248, 2179.1531959025619,
    2.076134778535264, 1.1034248885126443, 115.23959249335741,
    114.52626000887216, 0.13654658400839229, 0.07064518663462982,
    0.0444214611851993, 0.018115679267485946, -0.026268188155637414,
    -1.7701427855146033E-7, 14.093289102258403, -634.12756964711787,
    17.165206461763123, 2303.2651502242397, 2.0681218017118757,
    1.1004207033536917, 115.31323869838928, 114.55958613571784,
    0.11487215688690026, 0.059376971435581946, 0.039790796102273783,
    0.016189568056717122, -0.026298713695696519, -1.54358927901758E-7,
    14.103544590168049, -708.46239193949168, 17.167238646672054,
    2423.6836771045023, 2.0629178900654255, 1.0977019110980466,
    115.34205792176017, 114.53868655534036, 0.091561796418241623,
    0.047243845990686442, 0.034155615644273531, 0.013863799355269178,
    -0.026287169769759231, -1.2890693147708468E-7, 14.097690455380858,
    -785.49349648932423, 17.166079409922169, 2540.1656314848633,
    2.059932600381714, 1.0953405950854522, 115.33254399336914,
    114.47124075514759, 0.067851716659663719, 0.034922985179938325,
    0.027770527697953525, 0.011244663743854874, -0.026234935814959216,
    -1.0188906566618698E-7, 14.07630326254224, -864.868287773363,
    17.161826648251889, 2652.5115333894842, 2.0586757662432538,
    1.0933507263265667, 115.29024057298641, 114.36388940075467,
    0.045111768031139123, 0.023150739430369775, 0.020887754957294172,
    0.0084378325313087532, -0.026140781756779051, -7.4448659000046747E-8,
    14.039165089111485, -946.23063201776824, 17.154375999470684,
    2760.5657534627153, 2.058714925083645, 1.0917193140905637,
    115.21992301940386, 114.22239931503499, 0.024916587320579792,
    0.012751216704866786, 0.013768556731030841, 0.0055518847788654712,
    -0.026000018028188333, -4.7664737588975561E-8, 13.984986009093697,
    -1029.2264578939819, 17.143356501507746, 2864.2156028163877,
    2.0596353761737474, 1.0904260552584082, 115.12576364130291,
    114.05182473932503, 0.0091295368694199359, 0.0046684149140509877,
    0.0066969535052586451, 0.0027004870848901545, -0.025803387996071712,
    -2.2561636026333212E-8, 13.911133743047921, -1113.5088632288644,
    17.128048233680452, 2963.3895762404482, 2.061002771297419,
    1.0894553396089948, 115.01147293301182, 113.85665302594055 };

  double lambdaNextVal[96];
  double xPrevVal[96];
  static const double dv3[96] = { -0.592347592483623, -0.26208248839420956,
    -0.29659252143872733, -0.11782660999322103, -0.524546051909047,
    -0.21581707055902932, -0.24334147023434147, -0.097315719935223643,
    -0.44230183879489826, -0.17594925417041937, -0.19748560811761698,
    -0.078754925206406659, -0.3509987129020376, -0.13991470515557414,
    -0.15909194610614269, -0.061645178325221484, -0.23100906756179274,
    -0.092349088252099282, -0.1154531604300526, -0.044293426184101169,
    -0.12160899977502528, -0.047481322032883605, -0.076607033046593734,
    -0.029012639030265904, -0.029247730824533635, -0.0078383526702277134,
    -0.0435281880873993, -0.016057047230238694, 0.044255551019845255,
    0.025267859019356829, -0.016377840884230596, -0.00542993696730277,
    0.099713127668592458, 0.051429752487784315, 0.0051645276657654744,
    0.0030123922514791795, 0.13911808436982442, 0.070827879053194653,
    0.0216561149825531, 0.0094855835551130377, 0.16478196437670431,
    0.083977195658888087, 0.033733784979962322, 0.014229066379859602,
    0.17891344957579272, 0.091551394760089624, 0.042024709843324522,
    0.017478227594761846, 0.18346598508993783, 0.0942756676001637,
    0.047102788712118232, 0.019450429458209795, 0.1801233552072361,
    0.092870087708672514, 0.04947327487085771, 0.02033974970590172,
    0.1703435541985075, 0.088026443061096818, 0.049573212826543644,
    0.020316805779059127, 0.15542046801991691, 0.080405385620325384,
    0.047779722739944873, 0.019531277750401626, 0.13654658400839229,
    0.07064518663462982, 0.0444214611851993, 0.018115679267485946,
    0.11487215688690026, 0.059376971435581946, 0.039790796102273783,
    0.016189568056717122, 0.091561796418241623, 0.047243845990686442,
    0.034155615644273531, 0.013863799355269178, 0.067851716659663719,
    0.034922985179938325, 0.027770527697953525, 0.011244663743854874,
    0.045111768031139123, 0.023150739430369775, 0.020887754957294172,
    0.0084378325313087532, 0.024916587320579792, 0.012751216704866786,
    0.013768556731030841, 0.0055518847788654712, 0.0091295368694199359,
    0.0046684149140509877, 0.0066969535052586451, 0.0027004870848901545, 0.0,
    0.0, 0.0, 0.0 };

  static const double dv4[96] = { 1.0, 0.5, 100.0, 100.0, 1.5706148303913288,
    0.502277887256571, 101.20053080590365, 100.72125862092351,
    2.0461377362994768, 0.53809405616492445, 102.55594514248955,
    101.82218930213877, 2.4088077073332022, 0.59584096288976374,
    104.0543691697771, 103.15789003151362, 2.6556395675233606, 0.665529569932173,
    105.61476241714706, 104.6216785698122, 2.6591823080306236,
    0.77267868100134141, 107.12280159754938, 106.10214894962104,
    2.607211256403847, 0.8688769259751733, 108.51683379485218,
    107.51767224724082, 2.5299697854877286, 0.94851622399286917,
    109.7757264711844, 108.8228737212053, 2.4462261287241658, 1.009720431299318,
    110.88668043401066, 109.99188205780331, 2.3667432720812718,
    1.0534058638808663, 111.84627229430812, 111.01227236043023,
    2.2968426519917773, 1.0821881436501073, 112.65878532476303,
    111.8816474406763, 2.2383668631177351, 1.0993749009843068,
    113.33384778654452, 112.60485559391468, 2.191140520771099,
    1.1082236733487798, 113.88418717109808, 113.19153131051762,
    2.1539846187201985, 1.111516285390274, 114.32381128847359,
    113.65402055342675, 2.12535798088126, 1.1113999054062129, 114.66670112946579,
    114.00576618522005, 2.1037180402154356, 1.1094027182750421,
    114.92598286673727, 114.26016413651267, 2.0876922313050503,
    1.1065366040111746, 115.11348786800779, 114.42983985164911,
    2.076134778535264, 1.1034248885126443, 115.23959249335741,
    114.52626000887216, 2.0681218017118757, 1.1004207033536917,
    115.31323869838928, 114.55958613571784, 2.0629178900654255,
    1.0977019110980466, 115.34205792176017, 114.53868655534036,
    2.059932600381714, 1.0953405950854522, 115.33254399336914,
    114.47124075514759, 2.0586757662432538, 1.0933507263265667,
    115.29024057298641, 114.36388940075467, 2.058714925083645,
    1.0917193140905637, 115.21992301940386, 114.22239931503499,
    2.0596353761737474, 1.0904260552584082, 115.12576364130291,
    114.05182473932503 };

  double dmu_u[144];
  double RTITime;
  double error;
  double simTimeStart;
  int step;
  double simTimeEnd;
  double timerRTIStart;
  int iter;
  int b_iter;
  boolean_T exitg1;
  double fileID;
  double timerRTIEnd;
  double MT_Val[384];
  int j;
  double A_Val[192];
  double P_Val[384];
  char cv0[3];
  double c_xCurrentState[4];
  double p_lambda_Lambda[384];
  double p_x_Lambda[384];
  char cv1[3];
  double p_x_F[384];
  double dx[96];
  double dlambda[96];
  double fu_Val[384];
  double fx_I_Val[384];
  double dKKT23_mu_u_Val[864];
  double Hux_Val[384];
  double Hxx_Val[384];
  double F_Val[96];
  double C_Val[48];
  double Hu_Val[96];
  double Lamda_Val[96];
  double Inv_fx_I_Val[384];
  double theta_uncrt[384];
  double Hux_Inv_fx_I_Val[384];
  double Cx_Inv_fx_I_Val[192];
  double fuT_Inv_fxT_I_Val[384];
  double c_fuT_theta_uncrt_m_Hux_Inv_fx_[384];
  double Inv_dKKT23_mu_u_Val[864];
  double p_lambda_muu[576];
  double p_x_muu[576];
  double p_muu_F[576];
  double p_muu_Lambda[576];
  double V_Val[48];
  double W_Val[96];
  int b_i;
  double d0;
  int i1;
  int i2;
  double b_dlambda[14];
  double b_theta[16];
  int i3;
  double b_Hxx_Val[16];
  double b_Inv_fx_I_Val[16];
  int i4;
  double b_Cx_Inv_fx_I_Val[8];
  double d1;
  double dv5[36];
  double dv6[24];
  double b_Hu_Val[4];
  double d_fuT_theta_uncrt_m_Hux_Inv_fx_[4];
  double b_V_Val[6];

  /* % For closed-loop simulation and code generation */
  /*  Date: Jan 21, 2018 */
  /*  Author: Haoyang Deng */
  /*  some other mpc parameters */
  for (i = 0; i < 4; i++) {
    xCurrentState[i] = b_xCurrentState[i];
  }

  /*  simulation variables */
  /*  Jacobian variables */
  /*  record variables */
  memset(&rec_x[0], 0, 1444U * sizeof(double));
  for (i0 = 0; i0 < 4; i0++) {
    rec_x[361 * i0] = dv0[i0];
  }

  memset(&rec_u[0], 0, 1440U * sizeof(double));
  memset(&rec_numIter[0], 0, 360U * sizeof(signed char));
  memset(&rec_error[0], 0, 360U * sizeof(double));
  memset(&rec_cpuTime[0], 0, 360U * sizeof(double));

  /*  problem variables */
  for (i0 = 0; i0 < 336; i0++) {
    currentEval[i0] = 0.0;
    currentIteration[i0] = dv2[i0];
  }

  memcpy(&theta[0], &dv1[0], 384U * sizeof(double));
  memcpy(&lambdaNextVal[0], &dv3[0], 96U * sizeof(double));
  memcpy(&xPrevVal[0], &dv4[0], 96U * sizeof(double));
  memset(&dmu_u[0], 0, 144U * sizeof(double));

  /*  time variables */
  RTITime = 0.0;
  error = 0.0;

  /* % Set number of threads */
  /*  Code generation */
  simTimeStart = omp_get_wtime();

  /* % Simulation */
  for (step = 0; step < 360; step++) {
    /* simulation steps */
    /*     %% Solve the optimal control problem */
    timerRTIStart = omp_get_wtime();
    iter = 1;
    b_iter = 0;
    exitg1 = false;
    while ((!exitg1) && (b_iter < 5)) {
      iter = b_iter + 1;

#pragma omp parallel for \
 num_threads(24 > omp_get_max_threads() ? omp_get_max_threads() : 24) \
 private(i2,i3,i4,d1) \
 firstprivate(b_Hxx_Val,b_Inv_fx_I_Val,b_Cx_Inv_fx_I_Val,dv5,dv6,b_Hu_Val,d_fuT_theta_uncrt_m_Hux_Inv_fx_,b_V_Val,b_dlambda)

      for (b_i = 0; b_i < 24; b_i++) {
        /*         %% Step 1: Coarse Iteration */
        /*             %% Jacobian Evaluation */
        GEN_Func_fu(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [16])&fu_Val[b_i << 4]);
        GEN_Func_fx_I(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [16])&fx_I_Val[b_i << 4]);
        GEN_Func_dKKT23_mu_u(*(double (*)[14])&currentIteration[14 * b_i],
                             *(double (*)[36])&dKKT23_mu_u_Val[36 * b_i]);
        GEN_Func_Hux(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [16])&Hux_Val[b_i << 4]);
        Func_Hxx_FD(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [16])&Hxx_Val[b_i << 4]);

        /*             %% Function Evaluation */
        GEN_Func_KKT(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [4])&xPrevVal[b_i << 2], *(double (*)[4])&lambdaNextVal[b_i << 2],
                     *(double (*)[14])&currentEval[14 * b_i]);
        for (i2 = 0; i2 < 4; i2++) {
          F_Val[i2 + (b_i << 2)] = currentEval[i2 + 14 * b_i];
        }

        for (i2 = 0; i2 < 2; i2++) {
          C_Val[i2 + (b_i << 1)] = currentEval[(i2 + 14 * b_i) + 4];
        }

        /*             %% Intermediate Variables */
        inv(*(double (*)[16])&fx_I_Val[b_i << 4], *(double (*)[16])&
            Inv_fx_I_Val[b_i << 4]);
        for (i2 = 0; i2 < 4; i2++) {
          Hu_Val[i2 + (b_i << 2)] = currentEval[(i2 + 14 * b_i) + 6];
          Lamda_Val[i2 + (b_i << 2)] = currentEval[(i2 + 14 * b_i) + 10];
          for (i3 = 0; i3 < 4; i3++) {
            b_Hxx_Val[i3 + (i2 << 2)] = Hxx_Val[(i3 + (i2 << 2)) + (b_i << 4)] -
              theta[(i3 + (i2 << 2)) + (b_i << 4)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            b_Inv_fx_I_Val[i2 + (i3 << 2)] = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              b_Inv_fx_I_Val[i2 + (i3 << 2)] += Inv_fx_I_Val[(i4 + (i2 << 2)) +
                (b_i << 4)] * b_Hxx_Val[i4 + (i3 << 2)];
            }
          }

          for (i3 = 0; i3 < 4; i3++) {
            theta_uncrt[(i2 + (i3 << 2)) + (b_i << 4)] = 0.0;
            Hux_Inv_fx_I_Val[(i2 + (i3 << 2)) + (b_i << 4)] = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              theta_uncrt[(i2 + (i3 << 2)) + (b_i << 4)] += b_Inv_fx_I_Val[i2 +
                (i4 << 2)] * Inv_fx_I_Val[(i4 + (i3 << 2)) + (b_i << 4)];
              Hux_Inv_fx_I_Val[(i2 + (i3 << 2)) + (b_i << 4)] += Hux_Val[(i2 +
                (i4 << 2)) + (b_i << 4)] * Inv_fx_I_Val[(i4 + (i3 << 2)) + (b_i <<
                4)];
            }
          }
        }

        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            Cx_Inv_fx_I_Val[(i2 + (i3 << 1)) + (b_i << 3)] = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              Cx_Inv_fx_I_Val[(i2 + (i3 << 1)) + (b_i << 3)] += 0.0 *
                Inv_fx_I_Val[(i4 + (i3 << 2)) + (b_i << 4)];
            }
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            fuT_Inv_fxT_I_Val[(i2 + (i3 << 2)) + (b_i << 4)] = 0.0;
            d1 = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              fuT_Inv_fxT_I_Val[(i2 + (i3 << 2)) + (b_i << 4)] += fu_Val[(i4 +
                (i2 << 2)) + (b_i << 4)] * Inv_fx_I_Val[(i3 + (i4 << 2)) + (b_i <<
                4)];
              d1 += fu_Val[(i4 + (i2 << 2)) + (b_i << 4)] * theta_uncrt[(i4 +
                (i3 << 2)) + (b_i << 4)];
            }

            c_fuT_theta_uncrt_m_Hux_Inv_fx_[(i2 + (i3 << 2)) + (b_i << 4)] = d1
              - Hux_Inv_fx_I_Val[(i2 + (i3 << 2)) + (b_i << 4)];
            MT_Val[(i3 + (i2 << 2)) + (b_i << 4)] = 0.0;
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            MT_Val[(i2 + (i3 << 2)) + (b_i << 4)] = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              MT_Val[(i2 + (i3 << 2)) + (b_i << 4)] += fu_Val[(i4 + (i2 << 2)) +
                (b_i << 4)] * Hux_Inv_fx_I_Val[(i3 + (i4 << 2)) + (b_i << 4)];
            }
          }

          for (i3 = 0; i3 < 2; i3++) {
            A_Val[(i3 + (i2 << 1)) + (b_i << 3)] = 0.0;
            b_Cx_Inv_fx_I_Val[i3 + (i2 << 1)] = -Cx_Inv_fx_I_Val[(i3 + (i2 << 1))
              + (b_i << 3)];
          }
        }

        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            A_Val[(i2 + (i3 << 1)) + (b_i << 3)] = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              A_Val[(i2 + (i3 << 1)) + (b_i << 3)] += b_Cx_Inv_fx_I_Val[i2 + (i4
                << 1)] * fu_Val[(i4 + (i3 << 2)) + (b_i << 4)];
            }
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            d1 = 0.0;
            for (i4 = 0; i4 < 4; i4++) {
              d1 += c_fuT_theta_uncrt_m_Hux_Inv_fx_[(i2 + (i4 << 2)) + (b_i << 4)]
                * fu_Val[(i4 + (i3 << 2)) + (b_i << 4)];
            }

            P_Val[(i2 + (i3 << 2)) + (b_i << 4)] = d1 - MT_Val[(i2 + (i3 << 2))
              + (b_i << 4)];
          }
        }

        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 2; i3++) {
            dv5[i3 + 6 * i2] = 0.0;
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 2; i3++) {
            dv5[i3 + 6 * (i2 + 2)] = A_Val[(i3 + (i2 << 1)) + (b_i << 3)];
          }
        }

        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            dv5[(i3 + 6 * i2) + 2] = A_Val[(i2 + (i3 << 1)) + (b_i << 3)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            dv5[(i3 + 6 * (i2 + 2)) + 2] = P_Val[(i3 + (i2 << 2)) + (b_i << 4)];
          }
        }

        for (i2 = 0; i2 < 6; i2++) {
          for (i3 = 0; i3 < 6; i3++) {
            dKKT23_mu_u_Val[(i3 + 6 * i2) + 36 * b_i] += dv5[i3 + 6 * i2];
          }
        }

        b_inv(*(double (*)[36])&dKKT23_mu_u_Val[36 * b_i], *(double (*)[36])&
              Inv_dKKT23_mu_u_Val[36 * b_i]);

        /*             %% Sensitivity */
        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_lambda_muu[(i3 + (i2 << 2)) + 24 * b_i] = -Cx_Inv_fx_I_Val[(i2 +
              (i3 << 1)) + (b_i << 3)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_lambda_muu[(i3 + ((i2 + 2) << 2)) + 24 * b_i] =
              c_fuT_theta_uncrt_m_Hux_Inv_fx_[(i2 + (i3 << 2)) + (b_i << 4)];
          }
        }

        for (i2 = 0; i2 < 2; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_x_muu[(i3 + (i2 << 2)) + 24 * b_i] = 0.0;
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_x_muu[(i3 + ((i2 + 2) << 2)) + 24 * b_i] = -fuT_Inv_fxT_I_Val[(i2
              + (i3 << 2)) + (b_i << 4)];
          }
        }

        for (i2 = 0; i2 < 6; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_muu_F[(i2 + 6 * i3) + 24 * b_i] = 0.0;
            for (i4 = 0; i4 < 6; i4++) {
              p_muu_F[(i2 + 6 * i3) + 24 * b_i] += Inv_dKKT23_mu_u_Val[(i2 + 6 *
                i4) + 36 * b_i] * p_lambda_muu[(i3 + (i4 << 2)) + 24 * b_i];
            }
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 2; i3++) {
            dv6[i3 + 6 * i2] = 0.0;
          }

          for (i3 = 0; i3 < 4; i3++) {
            dv6[(i3 + 6 * i2) + 2] = -fuT_Inv_fxT_I_Val[(i3 + (i2 << 2)) + (b_i <<
              4)];
          }
        }

        for (i2 = 0; i2 < 6; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_muu_Lambda[(i2 + 6 * i3) + 24 * b_i] = 0.0;
            for (i4 = 0; i4 < 6; i4++) {
              p_muu_Lambda[(i2 + 6 * i3) + 24 * b_i] += Inv_dKKT23_mu_u_Val[(i2
                + 6 * i4) + 36 * b_i] * dv6[i4 + 6 * i3];
            }
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            d1 = 0.0;
            for (i4 = 0; i4 < 6; i4++) {
              d1 += p_lambda_muu[(i2 + (i4 << 2)) + 24 * b_i] * p_muu_Lambda[(i4
                + 6 * i3) + 24 * b_i];
            }

            p_lambda_Lambda[(i2 + (i3 << 2)) + (b_i << 4)] = d1 + Inv_fx_I_Val
              [(i3 + (i2 << 2)) + (b_i << 4)];
            p_x_Lambda[(i3 + (i2 << 2)) + (b_i << 4)] = 0.0;
          }
        }

        /*             %% theta = p_lambda_F */
        for (i2 = 0; i2 < 4; i2++) {
          for (i3 = 0; i3 < 4; i3++) {
            p_x_Lambda[(i2 + (i3 << 2)) + (b_i << 4)] = 0.0;
            d1 = 0.0;
            for (i4 = 0; i4 < 6; i4++) {
              p_x_Lambda[(i2 + (i3 << 2)) + (b_i << 4)] += p_x_muu[(i2 + (i4 <<
                2)) + 24 * b_i] * p_muu_Lambda[(i4 + 6 * i3) + 24 * b_i];
              d1 += p_x_muu[(i2 + (i4 << 2)) + 24 * b_i] * p_muu_F[(i4 + 6 * i3)
                + 24 * b_i];
            }

            p_x_F[(i2 + (i3 << 2)) + (b_i << 4)] = d1 + Inv_fx_I_Val[(i2 + (i3 <<
              2)) + (b_i << 4)];
            d1 = 0.0;
            for (i4 = 0; i4 < 6; i4++) {
              d1 += p_lambda_muu[(i2 + (i4 << 2)) + 24 * b_i] * p_muu_F[(i4 + 6 *
                i3) + 24 * b_i];
            }

            theta[(i2 + (i3 << 2)) + (b_i << 4)] = d1 - theta_uncrt[(i2 + (i3 <<
              2)) + (b_i << 4)];
          }
        }

        /*             %% Coarse Iteration */
        for (i2 = 0; i2 < 2; i2++) {
          d1 = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            d1 += Cx_Inv_fx_I_Val[(i2 + (i3 << 1)) + (b_i << 3)] * F_Val[i3 +
              (b_i << 2)];
          }

          V_Val[i2 + (b_i << 1)] = C_Val[i2 + (b_i << 1)] - d1;
        }

        for (i2 = 0; i2 < 4; i2++) {
          d1 = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            d1 += fuT_Inv_fxT_I_Val[(i2 + (i3 << 2)) + (b_i << 4)] *
              Lamda_Val[i3 + (b_i << 2)];
          }

          b_Hu_Val[i2] = Hu_Val[i2 + (b_i << 2)] - d1;
          d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] +=
              c_fuT_theta_uncrt_m_Hux_Inv_fx_[(i2 + (i3 << 2)) + (b_i << 4)] *
              F_Val[i3 + (b_i << 2)];
          }

          W_Val[i2 + (b_i << 2)] = b_Hu_Val[i2] +
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2];
        }

        for (i2 = 0; i2 < 2; i2++) {
          b_V_Val[i2] = V_Val[i2 + (b_i << 1)];
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_V_Val[i2 + 2] = W_Val[i2 + (b_i << 2)];
        }

        for (i2 = 0; i2 < 6; i2++) {
          dmu_u[i2 + 6 * b_i] = 0.0;
          for (i3 = 0; i3 < 6; i3++) {
            dmu_u[i2 + 6 * b_i] += Inv_dKKT23_mu_u_Val[(i2 + 6 * i3) + 36 * b_i]
              * b_V_Val[i3];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_Hu_Val[i2] = 0.0;
          for (i3 = 0; i3 < 6; i3++) {
            b_Hu_Val[i2] += p_x_muu[(i2 + (i3 << 2)) + 24 * b_i] * dmu_u[i3 + 6 *
              b_i];
          }

          d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            b_Hxx_Val[i3 + (i2 << 2)] = -theta_uncrt[(i3 + (i2 << 2)) + (b_i <<
              4)];
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] += Inv_fx_I_Val[(i2 + (i3 << 2))
              + (b_i << 4)] * F_Val[i3 + (b_i << 2)];
          }

          dx[i2 + (b_i << 2)] = b_Hu_Val[i2] +
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2];
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_Hu_Val[i2] = 0.0;
          d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            b_Hu_Val[i2] += b_Hxx_Val[i2 + (i3 << 2)] * F_Val[i3 + (b_i << 2)];
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2] += Inv_fx_I_Val[(i3 + (i2 << 2))
              + (b_i << 4)] * Lamda_Val[i3 + (b_i << 2)];
          }

          d1 = 0.0;
          for (i3 = 0; i3 < 6; i3++) {
            d1 += p_lambda_muu[(i2 + (i3 << 2)) + 24 * b_i] * dmu_u[i3 + 6 * b_i];
          }

          dlambda[i2 + (b_i << 2)] = (b_Hu_Val[i2] +
            d_fuT_theta_uncrt_m_Hux_Inv_fx_[i2]) + d1;
          b_dlambda[i2] = dlambda[i2 + (b_i << 2)];
        }

        for (i2 = 0; i2 < 6; i2++) {
          b_dlambda[i2 + 4] = dmu_u[i2 + 6 * b_i];
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_dlambda[i2 + 10] = dx[i2 + (b_i << 2)];
        }

        for (i2 = 0; i2 < 14; i2++) {
          currentIteration[i2 + 14 * b_i] -= b_dlambda[i2];
        }
      }

      /*         %% Step 2: Backward correction due to the approximation of lambda */
      for (i = 0; i < 23; i++) {
        for (i0 = 0; i0 < 4; i0++) {
          dlambda[i0 + ((22 - i) << 2)] = currentIteration[i0 + 14 * (23 - i)] -
            lambdaNextVal[i0 + ((22 - i) << 2)];
        }

        for (i0 = 0; i0 < 4; i0++) {
          d0 = 0.0;
          for (i1 = 0; i1 < 4; i1++) {
            d0 += p_lambda_Lambda[(i0 + (i1 << 2)) + ((22 - i) << 4)] *
              dlambda[i1 + ((22 - i) << 2)];
          }

          currentIteration[i0 + 14 * (22 - i)] -= d0;
        }
      }

#pragma omp parallel for \
 num_threads(24 > omp_get_max_threads() ? omp_get_max_threads() : 24) \
 private(i2,i3) \
 firstprivate(b_dlambda)

      for (b_i = 0; b_i < 23; b_i++) {
        for (i2 = 0; i2 < 6; i2++) {
          dmu_u[i2 + 6 * b_i] = 0.0;
          dmu_u[i2 + 6 * b_i] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            dmu_u[i2 + 6 * b_i] += p_muu_Lambda[(i2 + 6 * i3) + 24 * b_i] *
              dlambda[i3 + (b_i << 2)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          dx[i2 + (b_i << 2)] = 0.0;
          dx[i2 + (b_i << 2)] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            dx[i2 + (b_i << 2)] += p_x_Lambda[(i2 + (i3 << 2)) + (b_i << 4)] *
              dlambda[i3 + (b_i << 2)];
          }

          b_dlambda[i2] = 0.0;
        }

        for (i2 = 0; i2 < 6; i2++) {
          b_dlambda[i2 + 4] = dmu_u[i2 + 6 * b_i];
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_dlambda[i2 + 10] = dx[i2 + (b_i << 2)];
        }

        for (i2 = 0; i2 < 14; i2++) {
          currentIteration[i2 + 14 * b_i] -= b_dlambda[i2];
        }
      }

      /*         %% Step 3: Forward correction due to the approximation of x */
      for (i = 0; i < 23; i++) {
        for (i0 = 0; i0 < 4; i0++) {
          dx[i0 + ((i + 1) << 2)] = currentIteration[(i0 + 14 * i) + 10] -
            xPrevVal[i0 + ((i + 1) << 2)];
        }

        for (i0 = 0; i0 < 4; i0++) {
          d0 = 0.0;
          for (i1 = 0; i1 < 4; i1++) {
            d0 += p_x_F[(i0 + (i1 << 2)) + ((i + 1) << 4)] * dx[i1 + ((i + 1) <<
              2)];
          }

          currentIteration[(i0 + 14 * (i + 1)) + 10] -= d0;
        }
      }

#pragma omp parallel for \
 num_threads(24 > omp_get_max_threads() ? omp_get_max_threads() : 24) \
 private(i2,i3) \
 firstprivate(b_dlambda)

      for (b_i = 0; b_i < 23; b_i++) {
        for (i2 = 0; i2 < 6; i2++) {
          dmu_u[i2 + 6 * (b_i + 1)] = 0.0;
        }

        for (i2 = 0; i2 < 6; i2++) {
          dmu_u[i2 + 6 * (b_i + 1)] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            dmu_u[i2 + 6 * (b_i + 1)] += p_muu_F[(i2 + 6 * i3) + 24 * (b_i + 1)]
              * dx[i3 + ((b_i + 1) << 2)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          dlambda[i2 + ((b_i + 1) << 2)] = 0.0;
        }

        for (i2 = 0; i2 < 4; i2++) {
          dlambda[i2 + ((b_i + 1) << 2)] = 0.0;
          for (i3 = 0; i3 < 4; i3++) {
            dlambda[i2 + ((b_i + 1) << 2)] += theta[(i2 + (i3 << 2)) + ((b_i + 1)
              << 4)] * dx[i3 + ((b_i + 1) << 2)];
          }
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_dlambda[i2] = dlambda[i2 + ((b_i + 1) << 2)];
        }

        for (i2 = 0; i2 < 6; i2++) {
          b_dlambda[i2 + 4] = dmu_u[i2 + 6 * (b_i + 1)];
        }

        for (i2 = 0; i2 < 4; i2++) {
          b_dlambda[i2 + 10] = 0.0;
        }

        for (i2 = 0; i2 < 14; i2++) {
          currentIteration[i2 + 14 * (b_i + 1)] -= b_dlambda[i2];
        }
      }

      /*         %% Update Coupling Variables */
      /*         %% Update theta */
      for (i = 0; i < 23; i++) {
        for (i0 = 0; i0 < 4; i0++) {
          xPrevVal[i0 + ((i + 1) << 2)] = currentIteration[(i0 + 14 * i) + 10];
          lambdaNextVal[i0 + (i << 2)] = currentIteration[i0 + 14 * (i + 1)];
          for (i1 = 0; i1 < 4; i1++) {
            b_theta[i1 + (i0 << 2)] = theta[(i1 + (i0 << 2)) + ((i + 1) << 4)];
          }
        }

        for (i0 = 0; i0 < 4; i0++) {
          for (i1 = 0; i1 < 4; i1++) {
            theta[(i1 + (i0 << 2)) + (i << 4)] = b_theta[i1 + (i0 << 2)];
          }
        }
      }

      for (i0 = 0; i0 < 4; i0++) {
        for (i1 = 0; i1 < 4; i1++) {
          theta[368 + (i1 + (i0 << 2))] = 0.0;
        }
      }

#pragma omp parallel for \
 num_threads(24 > omp_get_max_threads() ? omp_get_max_threads() : 24)

      for (b_i = 0; b_i < 24; b_i++) {
        /*         %% Check termination */
        GEN_Func_KKT(*(double (*)[14])&currentIteration[14 * b_i], *(double (*)
          [4])&xPrevVal[b_i << 2], *(double (*)[4])&lambdaNextVal[b_i << 2],
                     *(double (*)[14])&currentEval[14 * b_i]);
      }

      error = norm(currentEval);
      if (error < 1.0E-7) {
        exitg1 = true;
      } else {
        b_iter++;
      }
    }

    timerRTIEnd = omp_get_wtime();
    RTITime = (RTITime + timerRTIEnd) - timerRTIStart;

    /*     %% Obtain the first optimal control input */
    /*     %% System simulation by the 4th-order Explicit Runge-Kutta Method */
    for (i = 0; i < 4; i++) {
      c_xCurrentState[i] = xCurrentState[i];
    }

    FuncPlantSim(*(double (*)[4])&currentIteration[6], c_xCurrentState,
                 0.0013888888888888889, xCurrentState);

    /*     %% Update parameters */
    /*  Update coupling variable */
    /* >>>>>>------------------FOR_USER---------------------------->>>>>> */
    /*  MPC parameters */
    /*  Simulation plant parameters */
    /* <<<<<<----------------END_FOR_USER--------------------------<<<<<< */
    /*     %% Record data */
    for (i0 = 0; i0 < 4; i0++) {
      xPrevVal[i0] = xCurrentState[i0];
      rec_x[(step + 361 * i0) + 1] = xCurrentState[i0];
      rec_u[step + 360 * i0] = currentIteration[6 + i0];
    }

    rec_error[step] = error;
    rec_cpuTime[step] = timerRTIEnd - timerRTIStart;
    rec_numIter[step] = (signed char)iter;
  }

  /*  end of simulation */
  simTimeEnd = omp_get_wtime();

  /* % Log to file */
  /*  Code generation */
  /*     %% show Time Elapsed for RTI */
  printf("Time Elapsed for RTI (Real Time Iteration): %f seconds\r\n", RTITime);
  printf("Time Elapsed for RTI+Simulation: %f seconds\r\n", simTimeEnd -
         simTimeStart);

  /*     %% Log to file */
  fileID = b_fopen();

  /*  printf header */
  for (j = 0; j < 4; j++) {
    cv0[0] = 'x';
    cv0[1] = (signed char)(j + 49);
    cv0[2] = '\x00';
    cfprintf(fileID, cv0);
  }

  for (j = 0; j < 4; j++) {
    cv1[0] = 'u';
    cv1[1] = (signed char)(j + 49);
    cv1[2] = '\x00';
    cfprintf(fileID, cv1);
  }

  b_cfprintf(fileID, "error");
  b_cfprintf(fileID, "numIter");
  c_cfprintf(fileID, "cpuTime");

  /*  printf data */
  for (i = 0; i < 360; i++) {
    for (j = 0; j < 4; j++) {
      d_cfprintf(fileID, rec_x[i + 361 * j]);
    }

    for (j = 0; j < 4; j++) {
      d_cfprintf(fileID, rec_u[i + 360 * j]);
    }

    d_cfprintf(fileID, rec_error[i]);
    d_cfprintf(fileID, rec_numIter[i]);
    e_cfprintf(fileID, rec_cpuTime[i]);
  }

  b_fclose(fileID);

  /*  end of function */
  /* _END_OF_FILE_ */
}

/*
 * File trailer for ParNMPC.c
 *
 * [EOF]
 */
